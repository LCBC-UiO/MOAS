<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PGS functions • MOAS</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="PGS functions">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MOAS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/MOAS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/PGS_functions.html">PGS functions</a>
    </li>
    <li>
      <a href="../articles/find-subject-timepoint.html">Find subject timepoint</a>
    </li>
    <li>
      <a href="../articles/make_documentation.html">Make documentation pages</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LCBC-UiO/MOAS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>PGS functions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/LCBC-UiO/MOAS/blob/master/vignettes/PGS_functions.Rmd"><code>vignettes/PGS_functions.Rmd</code></a></small>
      <div class="hidden name"><code>PGS_functions.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(MOAS)</a></code></pre></div>
<p>There are several functions in this package that should aid anyone working with PGS’s to add the PGS they want to their data. While the MOAS-data does contain PGS data, you might want to use some other PGS’s than already provided in the MOAS, or you might want to have more accompanying data with the PGSs (like the SNP counts). There are a couple of requisites to having these functions work:</p>
<ol style="list-style-type: decimal">
<li>You need to be able to connect to the LCBC lagringshotell, and know the path to the lagringshotell within your system.<br>
</li>
<li>The PGS data needs to be ordered in a directory, where each PGS has its own sub-directory with all the files with the different significance levels for that PGS are stored within these subdirectories with naming conventions like these: <code>AAmenarche/AAmenarche.S10.profile</code>, <code>AAmenarche//AAmenarche.S3.profile</code> etc.</li>
</ol>
<p>Given these two things, the functions should be fairly simple to use.</p>
<div id="the-two-main-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#the-two-main-functions" class="anchor"></a>The two main functions</h2>
<p>In the following examples the “~” (tilde) sign is a short-hand for where-ever on your system the LCBC lagringshotell is mounted. Depending on your OS and setup, you may need to change “~” to something else to make this work. The remaining paths point to two important places. The first being the path containing the PGS subdirectories, and the second to the cleaned file that enables matching between the PGS data and the MOAS. A consequence of using the <code>genetic_match_file</code> is also that the number of rows in the source PGS files are reduced to only those samples that we have verified as trustworty.</p>
<div id="getting-pgs-data" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-pgs-data" class="anchor"></a>Getting PGS data</h3>
<p>The first key function is <code>pgs_get</code> which will create a data.frame of the PGS’s you have asked for with the command.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_get.html">pgs_get</a></span>(<span class="dt">pgs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"AD"</span>, <span class="st">"AD_Jansen"</span>),</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">        <span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">        <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>)</a></code></pre></div>
<p>In this example, the user is asking for PGS for AD, and AD_Jansen, and will be given back a data.frame with these PGSs. The functions by default assumes you want the significance levels S1, S7, and S11, but you may overwrite this by using the <code>s_levels</code> argument.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_get.html">pgs_get</a></span>(<span class="dt">pgs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"AD"</span>, <span class="st">"AD_Jansen"</span>),</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">        <span class="dt">s_levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S5"</span>, <span class="st">"S12"</span>, <span class="st">"S7"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">        <span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">        <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>)</a></code></pre></div>
</div>
<div id="adding-pgs-data-to-the-moas" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-pgs-data-to-the-moas" class="anchor"></a>Adding PGS data to the MOAS</h3>
<p>The two above codes will give data.frames with PGS data alone, and nothing else. If you are confident in how you handle data, the above might provide enough for you to be able to merge it with whatever data you have to work with. If you are less confident, or just want a simple solution, you can use the two functions specifically created for easy MOAS-merging. You need not use the entire MOAS for these two functions to work, you can be working with MOAS data that has already been subsetted, and you want to add PGS to that. The key feature must be that the data is MOAS-derived, as the functions assume a certain structure to the data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_add.html">pgs_add</a></span>(MOAS, </a>
<a class="sourceLine" id="cb4-2" data-line-number="2">        <span class="dt">pgs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"AD"</span>, <span class="st">"AD_Jansen"</span>,</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        <span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">        <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>,</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">        <span class="dt">s_levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S7"</span>, <span class="st">"S11"</span>))      </a></code></pre></div>
<p>The <code>pgs_add</code> function takes all the same arguments as the <code>pgs_get</code> function, with the addition of needing the MOAS-derived data. The output of this function, is the entire data.frame you provided (MOAS-derived) with the PGS columns appended to it. This function is also created such that you may use the pipe (<code>%&gt;%</code>) operator on it if you like using it.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">MOAS <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/pgs_add.html">pgs_add</a></span>(<span class="dt">pgs =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"AD"</span>, <span class="st">"AD_Jansen"</span>,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">          <span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">          <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>,</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">          <span class="dt">s_levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S7"</span>, <span class="st">"S11"</span>))      </a></code></pre></div>
</div>
<div id="the-_all-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#the-_all-functions" class="anchor"></a>The <code>_all</code> functions</h3>
<p>The two functions above have two companions, that end with <code>_all</code>. The two <code>_all</code>-functions are made to easily add/get all the available PFS’s from the path specified.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_get_all.html">pgs_get_all</a></span>(<span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">            <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>)</a></code></pre></div>
<p>In particular, most will not want all the significance levels outputted (there are 12, and this is the default behaviour for the <code>_all</code> functions). You may specify which significance levels you want by providing a character vector to the <code>s_levels</code> argument.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_add_all.html">pgs_add_all</a></span>(MOAS, </a>
<a class="sourceLine" id="cb7-2" data-line-number="2">            <span class="dt">s_levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S7"</span>, <span class="st">"S11"</span>),</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">            <span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">            <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>)</a></code></pre></div>
</div>
</div>
<div id="extra-options-to-all-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#extra-options-to-all-functions" class="anchor"></a>Extra options to all functions</h2>
<p>All the above functions also have a couple of extra arguments, for those interested in keeping certain information that is removed by default</p>
<div id="keeping-the-cnt-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#keeping-the-cnt-columns" class="anchor"></a>Keeping the <code>CNT</code> columns</h3>
<p>Some are also interested in keeping the two <code>CNT</code> columns from the PGS data, as these may provide valuable information about the PGS’s computed. To do this, you can provide the <code>include_cnt = TRUE</code> to the funciton, and those columns will also be added.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_get_all.html">pgs_get_all</a></span>(<span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">            <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">            <span class="dt">s_levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S7"</span>, <span class="st">"S11"</span>),</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">            <span class="dt">include_cnt =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
<div id="keeping-information-from-the-genetics-moas-matching-file" class="section level3">
<h3 class="hasAnchor">
<a href="#keeping-information-from-the-genetics-moas-matching-file" class="anchor"></a>Keeping information from the genetics-MOAS matching file</h3>
<p>Some might be debugging the data, or want to find some extra information about the source genetic samples. In this case, one can use the <code>include_genetics_debug = TRUE</code> argument, which will keep all the columns from the genetics-MOAS matching file in the outputted data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/pgs_get_all.html">pgs_get_all</a></span>(<span class="dt">pgs_path =</span> <span class="st">"~/LCBC/Projects/Cross_projects/Genetics/PGS/PGS_20190618/PGS_wAPOE/"</span>,</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">            <span class="dt">genetic_match_file =</span> <span class="st">"~/LCBC/Projects/Cross_projects/MOAS/data-raw/DNA/gID_MOAS_match.tsv"</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">            <span class="dt">s_levels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"S1"</span>, <span class="st">"S7"</span>, <span class="st">"S11"</span>),</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">            <span class="dt">include_genetics_debug =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#the-two-main-functions">The two main functions</a></li>
      <li><a href="#extra-options-to-all-functions">Extra options to all functions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Athanasia Mo Mowinckel.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
